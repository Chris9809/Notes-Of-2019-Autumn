# 计算机网络 第一章



> Author:yelihu
>
> Time:2019/08
>
> Description：



[TOC]

### 计算机在信息时代的作用

略

### 互联网概述

**互联网的两个重要特点**

- 连通性
- 共享性

#### 互联网

特指`Internet`，最典型、最大的网络。

#### 计算机网络

若干节点`node`和链路`link`组成

#### 互联网

通过路由器将多个网络连接起来，构成了一个覆盖范围更大的计算机网络，称之为互联网。

**什么是路由器：**

专用操作系统的专用计算机，实现分组交换的关键构件。



> 关于"云"
>
> 与网络相连的计算机叫做主机、主机可能是计算机、手机等智能设备
>
> 这个云的概念和现在的云cloud意义不同

***

#### 互联网的标准化

![image-20190827085914428](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190827085914428.png)

### 互联网组成

#### 互联网的边缘部分

由端系统组成，端就是末端，互联网的末端。一个端可能是计算机、手机甚至是互联网摄像头。

##### 计算机之间的通信

是指A主机的进程和B主机的进程之间通信称为计算机之间的通信。这种通信方式分为**CS架构**和**P2P架构**两大类，如下。

###### C/S方式

客户端请求服务，server是服务提供方。

例子：手机

*BS架构本质上是特殊的CS架构*

###### P2P方式

对等连接的方式，两个主机即使客户端也是服务端。

例子：BT下载

#### 互联网的核心部分

网络和他们相连的路由器组成核心部分，路由器的任务是分组交换。分组交换由电路交换发展改进而来。



##### 电路交换的主要特点

- 必须经过建立连接-通话-释放连接这三个过程

- 电路交换必定是<u>面向连接</u>的：一条链路被两个用户使用之后，其他用户无法占用
- 线路传输效率低：计算机通信具有突发性，电路的利用率很低。

exp：2部电话机只要用一根电线直接连接就能通话

![image-20190827091807120](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190827091807120.png)

**缺点：需要的电话线太多。n个电话互联就需要**
$$
C^2_n
$$
**根电话线。**

***

**交换机应运而生**

当A和B有需要连线的时候，交换机负责将两端相连。所采用的的交换方式就是==电路交换==，动态的分配线路资源。

**电路交换分为如下三个阶段**

![image-20190827092010209](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190827092010209.png)

一旦释放连接之后，其他用户才允许占用

![image-20190827093005680](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190827093005680.png)

***

##### 分组交换的主要特点

***

发送报文之前，将长报文分割为短报文，这个过程叫做**分组**。每一段会将其加上**Header（首部）**.

###### 关于Header

**Header中包含如下控制消息**

- 目的地址(发给谁？)
- <u>原地址(谁发的？)</u>
- 其他控制消息...

![image-20190903075611681](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903075611681.png)

**网络中的交换机，即可更根据Header中的地址，将报文发送给下一个结点交换机**

***这个过程类似物流发送中的中转站机制***

> **为什么Header中需要包含原地址？**
>
> 存在报文数据退回和需要知道发报文的人的信息的情况。



**没个分组在互联网中独立的选择传输路径**

*联想：在图中，两个顶点之间的路线可能有很多条*

> **那么，既然路线不一样，不同分组的报文就有可能有不同的到达时间。如何解决这样一个关于报文组织顺序的问题？**
>
> TCP/UDP的出现



接收端收到分组之后剥去首部，组成报文。

###### 关于交换机

互联网的核心部分是由许多网络和他们互联起来的路由器组成的。

路由器之中也有属于自己的==操作系统==（Cisco中的叫IOS,注意，和苹果手机的操作系统iOS不同）。



![image-20190903082843471](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903082843471.png)

###### 关于链路

链路指无源的点到点的物理连接。<u>数据链路=物理线路+通信协议</u>

- 互联网核心部分中的路由器之前使用==高速链路==相连接
- 互联网边缘部分的主机接入核心部分使用==低速链路==。

==注意，高速链路提高的是数据的发送速率！而不是传播速率==

***

**路由器具有且可以：**

- 多个网络接口
- 完成存储转发这个过程 

***

**路由器处理分组（存储转发）的过程如下：**

1. 获取报文
2. 放入cache，暂时存储
3. 查转发表，找到合适的端口
4. 转发给下一个路由器

***

###### 关于端口

无线网卡、网线接口都是一个端口。

一般路由器有很多端口，输入和输出端端口之间没有直接连线。

###### 分组交换的优缺点

**优点：**

![image-20190903085719228](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903085719228.png)

**缺点：**

很难保证服务质量(QOS:Quality Of Service)，具体缺点解释如下：

![image-20190903085937014](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903085937014.png)



> 可见，**时间延迟（存储转发需要排队）**和**开销（首部占用缓存）**是造成QOS难以保证的主要因素。



***

##### 电路交换和分组交换的区别

![image-20190903090241931](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903090241931.png)

> 上图可见，报文交换和分组交换都使用了存储转发的机制。



***

##### 总结：

| 类型                                                 | 适合交换方式 |
| ---------------------------------------------------- | ------------ |
| **连续型**较大的数据，传送时间**大于**建立传送的时间 | 电路交换     |
| **非连续**的报文                                     | 分组交换     |

**分组交换和报文交换的区别：**

1. 数据一次性的分大段传送，若丢失则重发。
2. 分组传送，需要加上大量控制消息，但是转发非常灵活。





***

### 计算机网络在我国发展(了解)

全国范围的公用计算机网络：

![image-20190903090618585](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903090618585.png)





***

### 计算机网络的类别

**计算机网络的分类方法：**

- 作用范围
  - 广域网：几十到几千公公里范围内
  - 城域网：五到五十公里范围内 
  - 局域网
- 使用者
  - 公用网：public network
  - 专用网：铁路网和军网之类的特殊业务网络
- 接入用户
  - 接入网(AN：access  network)





***

### 计算机网络的性能

> 问题导入：
>
> **如何评判计算机网络的好坏？**



***

#### 计算机网络的性能指标

##### 速率

是网络当中非常重要的性能指标，也叫比特（bit）率。(或者是KBit)，速率越大越好。

> 注意是Byte而不是bit

速率的单位是bit/s,kbit/s,(网络用bit计，存储空间用Byte计)

> 比如4x10^10bit/s 的数据量就记为**40G**bit/s



***

##### 带宽

带宽和速率在非通信领域，指的是一个东西。

单位是bit/s,kbit/s…和网络一样。



***

##### 吞吐量

单位时间内通过某个信道或者接口的数据量



***

##### 时延

数据从一端（发送端）到另一端（接收端）所需的时间，时延越短越好。

==总时延=发送时延+传播时延+处理时延+排队时延==

时延有如下几种：

***

###### 发送时延

也称为传播时延。从发出以第一个bit的数据开始，到**发送完成全部数据**。

公式如下：
$$
发送时延=\frac{数据帧长度（bit）}{发送速率(bit/s)}
$$

***

###### 传播时延

电磁波在信道中传播一定距离所需时间
$$
传播实验=\frac{信道长度（m）}{电磁波在信道上的传播速率(m/s)}
$$


该时延与距离和介质有关，距离越远越大。

传播速率与介质有关，光纤比铜线传播时延小。



***

###### 处理时延

**造成时延的原因是因为路由器需要干这样三件事:**

1. 分析首部
2. 提取数据
3. 差错检验和查找适当路由的时间



***

###### 排队时延

分组进入路由器中排队等待处理。网络繁忙，排队时延就长。

> 网络快不快，要看时延，有时候小时延低速率的网络的表现要比大时延高速率的网络要好。pang

***



==以上几种时延发生的位置，图示如下：==

![image-20190903092609664](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190903092609664.png)

处理时延和排队时延发生在结点内：

发送时延在信息上链路之前。

链路上发生的是传播实验，信息在介质中奔向下一个结点。

下一个结点继续处理（摘除首部和组成报文）-排队-发送….循环。



***

##### 利用率

网络的利用率和时延

![image-20190905143814067](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905143814067.png)

***

$$
D=\frac{D_0}{1-U}
$$

D0表示网络空闲时候的时延，D表示网络当前的时延。利用率表示为U，上述公式是三者之间的关系。

可见，当利用率上升的时候，1-U变小，当前时延增大，网络的速率变小。

***

#### 计算机网络的非功能性指标

费用、质量、标准化、可靠性、可扩展性和可升级性、管理维护….





***

### 计算机网络体系结构

分层次的体系机构。

#### 计算机网络体系结构的形成

**形成历史如下：**

- 1974年，IBM的系统网络体系结构SNA。不同的网络体系结构出现，不同设备很难互通，违背互联网的初衷。
- 1977年，ISO国际标准化组织成立机构，提出开发系统互练基本参考模型(OSI/RM)。
- 当前的事实标准是TCP/IP协议栈。



**OSI失败的原因如下，大爷的课可能会问：**

![image-20190905144834522](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905144834522.png)



***

#### 协议和划分层次

**协议的定义**

1. 数据格式
2. 数据时序

***

**协议的三要素**

- 语法
  - 数据
  - 控制消息
- 语义：控制消息的对应的响应
- 同步：事件的实现顺序的详细说明

***

**协议的形式**

1. 文字描述：是给用户来阅读的
2. 程序代码

***

**划分层次的举例**

![image-20190905145652218](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905145652218.png)

- **文件传送作为最高的一层**，主机1将文件递交给下层模块发送，主机2接收到之后，下层模块上交文件给上层模块。两方主机需要规定：
  - 确认能够接受文件
  - 确认统一的文件格式
- 通信服务作为第二层，为上一层提供服务（Service）。
- 网络接入模块，负责网络接口机械，为上层提供服务。



***

##### 划分层次的优点

- 各层独立：复杂问题提取单一模块处理。
- 灵活性好：部分的使用。
- 可分割的机构：各层用合适的技术实现。
- 易维护
- 促进标准化工作
- 控制差错
- 控制流量
- 封端和重装
- 服用和分用
- 建立连接和释放



##### 划分层次的缺点

- 影响效率
- 层次功能有交集



***

#### 五层体系结构

综合OSI和TCP/IP的优点，采用五层协议的体系机构来讲，这样较为简洁和取出。

如图：

![image-20190905151040810](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905151040810.png)

*如图，OSI提出7层结构，TCP/IP提出4层结构*



> - 为了方便，最下面两层（数据链路层、物理层）称为网络接口层
>
> - OSI七层体系结构记忆方法：All People Seem To Need Data Processing(所有人都需要数据处理）对应：Application Presentation Session Transportation Network Data-Link Physics



***

##### 应用层

**应用层协议定义**

应用进程之间的通信和交互

**应用层的协议**

- *DNS* 域名系统
- *HTTP* *"WWW"*应用协议
- *STMP* 电子邮件

***

![image-20190905153929162](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905153929162.png)

**数据在各层之间的传递过程解释：**

**发送机**：

- 数据先传送到应用层，加上应用层首部
- 应用层PDU传送到网络层，网络层首部加入
- 成为数据报文
- 数据报文加上链路层首部尾部，称为数据链路层的frame(帧)
- 将拿到的帧编程比特流传输到物理介质上

**接收机：**

- 对方物理层接收比特流，接收一个frame的
- 摘去头尾，编程数据报文
- 报文拿去首部获得pdu
- 拿去首部，获得...

***

**PDU**

对等层次之间的数据单位称为协议数据单元PDU<u>(拿书中的信封例子为例：拿着同样级别信封的，就是同级别的PDU)</u>

**对等层**

发送方的第i层的数据对应接收方的第i层数据，完全相等。

**协议栈**

两个主机之间传输信息，数据从一层的底部(发送端的应用层)不断向下**弹出**，再不断向上**压入**到(接收端主机的应用层)顶层。这一个过程就像两个**栈**。故这种说法叫做==协议栈==。

***

##### 运输层：

通用数据传输**服务**，为了两台主机之间的传输数据而服务。

强调通用性，不在为了一种特定的网络**应用**

**主要使用如下两种协议发送数据**

- TCP
- UDP



***

##### 网络层

负责分组交换别的主机提供的通信服务。将运输层提供的数据报文封装成组。

**TCP/IP体系结构中，网络层也叫做IP层。分组也叫做IP数据报，简称数据报，和分组一词同义**

教科书中，==网络层和网际层以及IP层都是一个意思==



***

##### *（数据）*链路层

数据从IP层的分组数据下来之后，封装为**一帧一帧的数据**，每一帧都有对应的**控制信息（同步、地址、差错顺序）**。

这样才能在一段数据链路中发送。



***

##### 物理层

数据发送的形式是二进制，这里需要考虑的是：需要用多大的电压去发送这个数据。





***

#### 实体、协议、服务和服务访问点

在计算机网络体系结构中，每一层次可以为上一层提供服务，上一层需要下一次提供服务

![image-20190905155519941](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190905155519941.png)

***

##### 实体

任何发送和接收数据的软硬件*(软件进程)*

##### 协议

对等实体之间通信的规则的集合

***

##### 协议的隐蔽性

下层的协议对上层是隐藏/透明/看不见的，下层协议与上层无关，只需要知道下层提供什么服务即可。

***

##### 协议和服务的区别

|            | 协议                 | 服务                                                         |
| ---------- | -------------------- | ------------------------------------------------------------ |
| 结构方向   | 水平                 | 垂直                                                         |
| 上层可见性 | **上层不可见**，透明 | 为上层提供接口，通过"==服务原语=="来交换指令，是**上层可见**的 |



***

##### 服务访问点

上下层交换信息的接口有个**抽象的地址**，或者说接口，称为==SAP==，上下层从这个Point中交换数据，**上下层之间交换的数据**叫做==SDU== 服务数据单元。

多个SDU可以合成一个PDU，一个SDU也可以划分为多个PDU(协议数据单元)

##### 服务用户

使用下层服务者提供的服务，这就叫服务用户。

> 计算机网络协议重要特点就是：协议必须将各种不利条件事先估计到。能够应付异常情况的网络协议才是正确的网络协议。



***

#### TCP/IP的体系结构

TCP/IP的结构框架如下

![image-20190910080354130](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190910080354130.png)

***

![image-20190910075925736](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190910075925736.png)

以TCP连接为例，他们的请求连接顺序是：

![image-20190910080307603](/Users/apple/Desktop/MarkDown笔记/文章图片/image-20190910080307603.png)

### 总结和重要概念：

- 计算机网络的定义?
- Internet和internet有什么区别？
- 什么是分组交换机制？三层ISP结构是什么？
- 什么是端系统？

端系统

- 互联网的边缘和核心部分的主体是什么？
- 计算机网络的通信方式有什么？哪两种？
- 按照作用范围，计算机网络分为？
- 计算机网络的性能指标有那几个？
- 发送时延和传播时延的计算公式？
- 计算机网络传输数据产生的总时延包括？
- 网络协议的定义和三要素的含义？
- 五层网络体系机构TCP和七层网络体系结构OSI的组成部分是什么，区别在哪里？
- TCP/UDP协议在那一层？
- 网络层最重要的协议是什么？
- 解释PDU/SAP/SDU/协议栈/对等层/实体

  

### 第一章习题抄录

